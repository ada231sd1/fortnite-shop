<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fortnite Live Shop</title>
<style>
body {
  background: #0b1220;
  color: white;
  font-family: Arial, sans-serif;
  padding: 20px;
  text-align: center;
}

h1 { margin-bottom: 10px; }
#timer { font-size: 18px; margin-bottom: 20px; }

.shop-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 15px;
}

.item {
  background: #111827;
  border-radius: 10px;
  padding: 10px;
  width: 160px;
  text-align: center;
  box-shadow: 0 0 8px rgba(0,0,0,0.5);
}

.item img {
  width: 140px;
  border-radius: 8px;
}

.price {
  margin-top: 5px;
  font-weight: bold;
}
</style>
</head>
<body>

<h1>Fortnite Item Shop</h1>
<div id="timer">Loading timer…</div>
<div class="shop-container" id="shop">Loading items…</div>

<script>
const API_KEY = "0bb8c918-19fa5ec5-2c8a4a1e-285d0816";
const API_URL = `https://fortniteapi.io/v2/shop?lang=en&token=${API_KEY}`;

// Next shop reset UTC (00:00)
function nextResetUTC() {
  const now = new Date();
  return new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()+1, 0,0,0));
}

// Countdown
setInterval(() => {
  const diff = nextResetUTC() - new Date();
  const h = Math.floor(diff / 3600000);
  const m = Math.floor((diff % 3600000) / 60000);
  const s = Math.floor((diff % 60000) / 1000);
  document.getElementById("timer").textContent = 
    `Shop refresh in ${h}h ${m}m ${s}s`;
}, 1000);

// Fetch and show shop
fetch(API_URL)
  .then(res => res.json())
  .then(data => {
    const shopEl = document.getElementById("shop");
    shopEl.innerHTML = "";
    
    if (!data.shop) {
      shopEl.innerText = "No shop data available.";
      return;
    }
    
    const allItems = [...data.shop.daily, ...data.shop.featured];
    allItems.forEach(item => {
      const vb = item.price;
      const usd = (vb * 0.005).toFixed(2);
      
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <div class="price">${vb} V‑Bucks ($${usd})</div>
      `;
      shopEl.appendChild(div);
    });
  })
  .catch(err => {
    document.getElementById("shop").innerText = "Failed to load shop.";
    console.error(err);
  });
</script>

</body>
</html>
